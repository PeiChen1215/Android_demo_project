# 超市管理系统（Android）客户使用说明

适用范围：本说明面向门店员工/管理人员，用于日常操作（商品、采购、库存、收银、报表）。

---

## 1. 安装与首次使用

### 1.1 安装 APK
1. 在手机上打开安装包（APK）并安装。
2. 如系统提示“禁止安装未知来源应用”，请按提示进入系统设置，允许本次安装后继续。

> 提示：本系统数据保存在本机（本地数据库），不同手机/不同设备的数据互不相通。

### 1.2 首次启动与通知权限
- 首次进入首页后，系统可能会请求“通知权限”（Android 13+）。
- 建议允许：用于“低库存预警”的通知提醒（仅对有库存相关权限的角色生效）。

---

## 2. 登录与首页

### 2.1 登录
1. 打开应用进入“登录”页面。
2. 输入“用户名/邮箱”和“密码”，点击“登录”。
3. 登录成功后进入首页；若提示“用户名不存在/密码错误”，请联系管理员确认账号。

### 2.2 首页功能入口
首页会显示：欢迎信息、当前用户信息、角色说明，以及功能入口按钮（不同角色看到的按钮不同）。

常见入口名称：
- 📦 商品管理（所有角色可见）
- 💳 销售收银（收银员/管理员可见）
- 🧾 收据列表（收银员/财务/管理员可见）
- 📋 库存盘点（库存管理员/管理员可见）
- 🛍️ 采购管理（采购员/管理员可见）
- 📊 营收报表（有权限的角色可见）

---

## 3. 角色与权限（概览）

系统常见角色：
- 系统管理员：拥有全部权限。
账号admin
密码admin123
- 库存管理员：库存相关操作（入库/出库/盘点/预警）。
账号stock1
密码123456
- 采购员：创建与提交采购单，查看审批历史。
账号buyer1
密码123456
- 收银员：收银销售（会扣减货架库存）。
账号cashier1
密码123456
- 财务/出纳：营收报表查看/导出，退单处理（如已开通）。
账号finance1
密码123456
> 看不到某个功能入口，通常是“当前账号权限不足”。

---

## 4. 商品管理 / 商品查询

入口：首页 → 📦 商品管理

### 4.1 商品列表
在商品列表可进行：
- 搜索：输入关键字后点击“搜索”。
- 清空搜索：点击“清空”。
- 查看详情：点击任意商品行进入详情。
- 查看库存记录：点击页面上的“记录/库存记录”入口（用于查看全局库存变更历史）。
- 分页加载：列表底部可能有“加载更多”。

权限说明：
- 管理员 / 库存管理员：进入的是“商品管理”（可新增/编辑）。
- 其他角色：进入的是“商品查询”（只读）。

### 4.2 商品详情
在商品详情页可查看：
- 商品名称、分类、价格
- 货架库存、仓库库存
- 品牌、单位、条码、描述
- 过期日期（如有设置）

当商品库存低于预警值时，会显示“库存不足”提示。

### 4.3 新增商品（管理员/库存管理员）
入口：商品列表右上角“添加”按钮

填写建议：
- 必填：商品名称、价格、货架库存
- 可选：品牌、分类、单位、条码、供应商、描述、仓库库存、仓库最低预警、过期日期

字段注意：
- 条码：仅支持 6–32 位字母/数字，并且必须唯一。
- 过期日期：格式为 `yyyy-MM-dd`（例如 `2026-01-31`）。

### 4.4 编辑商品（管理员）
入口：商品详情 → “编辑商品”

修改完成后保存。

### 4.5 删除商品（仅管理员）
入口：商品列表 → 长按商品 或 点击列表项操作中的“删除”

删除后会出现“撤销”提示，可在短时间内撤销恢复。

---

## 5. 库存调整（出库/仓库出库）

入口：商品详情（库存管理员）→ “管理库存”

当前支持两类操作：
- 货架下架（货架出库）：减少“货架库存”。
- 仓库出库：减少“仓库库存”。

操作步骤：
1. 选择操作类型。
2. 输入数量（必须大于 0）。
3. 备注（可选）。
4. 点击“保存”。

系统会在保存前校验库存是否足够：
- 货架库存不足：会提示“货架库存不足”。
- 仓库库存不足：会提示“仓库库存不足”。

---

## 6. 库存盘点与低库存预警

入口：首页 → 📋 库存盘点（库存管理员/管理员）

此页面包含两部分：
1. 盘点记录：展示历史盘点单（部分明细入口可能尚未开放）。
2. 低库存预警：列出库存不足的商品，并显示总数量。

### 6.1 导出低库存清单
在“低库存预警”区域点击“导出/分享”按钮，可生成 `low_stock_alerts.csv` 并通过系统分享发送到微信/邮箱等。

---

## 7. 采购管理

入口：首页 → 🛍️ 采购管理（采购员/管理员）

### 7.1 采购单列表
支持操作：
- 搜索：输入关键字（采购单名称或ID）
- 状态筛选：通过“状态”下拉选择（如 OPEN/SUBMITTED/APPROVED/RECEIVED/REJECTED/DRAFT/PENDING 等）
- 更多：
  - 供应商筛选
  - 排序（按日期/按名称/按状态）
- 点击采购单：进入采购单详情
- 加载更多：列表底部“加载更多”

### 7.2 新建采购单
在采购列表点击“新建采购单”按钮后，系统会自动创建一张状态为 OPEN 的采购单并刷新列表。

下一步：请在列表中点击刚创建的采购单进入详情，补充内容并保存/提交。

### 7.3 采购单详情（编辑/提交/审批/入库）
采购单详情包含：供应商、采购单名称、状态、采购明细行、总金额。

常用动作（会因“角色权限 + 采购单状态”而显示/隐藏）：
- 保存：在 OPEN/DRAFT/CREATED/REJECTED 等可编辑状态下保存采购单与明细。
- 提交：提交后进入 SUBMITTED，等待审批。
- 批准 / 拒绝：审批角色可填写备注并批准或拒绝。
- 入库：当采购单已批准（APPROVED）后，仓库/库存相关角色可执行“入库”，系统会根据采购明细更新库存，并将采购单标记为已入库（RECEIVED）。
- 审批历史：有权限时可查看审批记录。

重要规则：
- 采购单名称为必填项。
- 已入库（RECEIVED）的采购单不可再修改。
- 明细行必须选择商品，数量必须大于 0。

---

## 8. 销售收银（POS）

入口：首页 → 💳 销售收银（收银员/管理员）

### 8.1 添加销售行
1. 在“商品输入框”输入商品名称或条码：
   - 输入名称时会自动联想商品名，可直接点选。
   - 输入条码时系统会优先按条码匹配商品。
2. 输入数量。
3. 点击“添加”把该商品加入本次结算清单。

系统会做库存校验：若货架库存不足，会提示并阻止加入。

### 8.2 删除销售行
- 长按某一行可删除。
- 部分版本也支持行内删除按钮（若显示）。

### 8.3 结账
1. 选择支付方式（现金/银行卡/微信/支付宝）。
2. 输入“已付金额”，系统会显示“找零”。
3. 点击“结账”。

结账成功后：
- 会保存收据记录。
- 会扣减对应商品的“货架库存”。

---

## 9. 收据列表与退单

### 9.1 收据列表
入口：首页 → 🧾 收据列表

- 默认显示最近的收据（最多 200 条）。
- 点击某条收据进入详情。

### 9.2 收据详情
在收据详情可查看：
- 收据号、时间、支付方式、合计金额
- 明细商品列表
- 操作人（如系统有记录）

支持操作：
- 分享收据：生成文本内容并通过系统分享。
- 退单（如有权限且未退单）：
  1. 点击“退单”
  2. 填写退单原因（必填）
  3. 提交后系统会标记该收据“已退单”，并恢复对应商品的“货架库存”。

---

## 10. 营收报表

入口：首页 → 📊 营收报表（有权限的角色）

### 10.1 生成报表
- 选择统计周期：按日 / 按月
- 系统默认统计最近 30 天
- 列表中会展示每个周期的总额与笔数

说明：报表“总营收”会综合：
- 销售收入（正数）
- 退单退款（负数）
- 采购支出（负数）

### 10.2 查看明细
点击某一行周期，可查看该周期内的明细条目（sale/refund/purchase）。

### 10.3 导出报表（需导出权限）
若当前账号有导出权限，会显示“导出/分享”按钮，可生成 `revenue_report.csv` 并通过系统分享。

---

## 11. 低库存通知（后台监控）

系统会在后台定期检查低库存（约每 15 分钟一次），并在满足以下条件时发送通知：
- 手机已授予“通知权限”（Android 13+）。
- 当前登录角色具备库存相关权限（如库存管理员/管理员）。

如果收不到通知：
- 检查系统设置是否允许本应用通知。
- 确保账号是库存相关角色。

---

## 12. 常见问题（FAQ）

1) 看不到“采购管理 / 库存盘点 / 营收报表”等入口？
- 多数情况是账号权限不足，请联系管理员更换角色或授权。

2) 添加商品时提示条码无效/重复？
- 条码必须是 6–32 位字母或数字，并且不能与其他商品重复。

3) 结账时提示库存不足？
- 销售扣减的是“货架库存”，请先补足货架库存或调整销售数量。

4) 退单按钮不显示？
- 只有具备“退单/退款权限”的账号才会显示，且已退单的收据不能再次退单。

5) 导出按钮不显示？
- 报表导出/低库存导出可能受权限控制；如需导出请使用管理员/财务账号。

---

